<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>王智慧专属</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#EC4899',
                        accent: '#8B5CF6',
                        neutral: '#1F2937',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }
            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                color: transparent;
            }
            .input-focus {
                @apply focus:ring-2 focus:ring-primary/50 focus:border-primary focus:outline-none;
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen font-sans">
    <!-- 页面容器 -->
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 标题部分 -->
        <header class="text-center my-12 animate-fade-in">
            <h1 class="text-[clamp(2.5rem,8vw,5rem)] font-bold bg-gradient-to-r from-primary to-accent text-gradient text-shadow tracking-wider">
                王智慧专属
            </h1>
            <p class="text-gray-600 mt-4 text-lg md:text-xl">记录你的想法和愿望</p>
        </header>

        <!-- 主内容区 -->
        <main class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-12">
            <form id="wishForm" class="space-y-6">
                <!-- 想吃的东西 -->
                <div class="card-hover bg-blue-50 rounded-xl p-5">
                    <label for="food" class="block mb-2 text-lg font-medium text-gray-700 flex items-center">
                        <i class="fa fa-cutlery text-primary mr-3"></i>想吃的东西
                    </label>
                    <input 
                        type="text" 
                        id="food" 
                        name="food" 
                        placeholder="例如：火锅、冰淇淋、妈妈做的红烧肉..." 
                        class="w-full px-4 py-3 rounded-lg border border-gray-300 input-focus transition-all"
                    >
                </div>

                <!-- 想要的东西 -->
                <div class="card-hover bg-pink-50 rounded-xl p-5">
                    <label for="thing" class="block mb-2 text-lg font-medium text-gray-700 flex items-center">
                        <i class="fa fa-gift text-secondary mr-3"></i>想要的东西
                    </label>
                    <input 
                        type="text" 
                        id="thing" 
                        name="thing" 
                        placeholder="例如：一本好书、新鞋子、一次旅行..." 
                        class="w-full px-4 py-3 rounded-lg border border-gray-300 input-focus transition-all"
                    >
                </div>

                <!-- 想做的事 -->
                <div class="card-hover bg-purple-50 rounded-xl p-5">
                    <label for="activity" class="block mb-2 text-lg font-medium text-gray-700 flex items-center">
                        <i class="fa fa-calendar-check-o text-accent mr-3"></i>想做的事
                    </label>
                    <input 
                        type="text" 
                        id="activity" 
                        name="activity" 
                        placeholder="例如：学一门新技能、看一场电影、和朋友聚会..." 
                        class="w-full px-4 py-3 rounded-lg border border-gray-300 input-focus transition-all"
                    >
                </div>

                <!-- 提交按钮 -->
                <div class="text-center pt-4">
                    <button 
                        type="submit" 
                        class="bg-gradient-to-r from-primary to-accent text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2"
                    >
                        <i class="fa fa-paper-plane mr-2"></i>保存我的想法
                    </button>
                </div>
            </form>
        </main>

        <!-- 数据管理按钮 -->
        <div class="flex flex-wrap justify-center gap-4 mb-6">
            <button id="exportBtn" class="flex items-center bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                <i class="fa fa-download mr-2"></i>导出数据
            </button>
            <label for="importFile" class="cursor-pointer flex items-center bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                <i class="fa fa-upload mr-2"></i>导入数据
            </label>
            <input type="file" id="importFile" accept=".json" class="hidden">
            <button id="clearBtn" class="flex items-center bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors">
                <i class="fa fa-trash mr-2"></i>清空所有数据
            </button>
        </div>

        <!-- 历史记录区域 -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold text-center mb-6 text-neutral">
                <i class="fa fa-history text-primary mr-2"></i>历史记录
            </h2>
            <div id="historyContainer" class="space-y-4 max-h-96 overflow-y-auto p-4 bg-white rounded-2xl shadow-md">
                <!-- 历史记录将通过JavaScript动态添加 -->
                <p class="text-gray-500 text-center italic" id="emptyHistory">暂无记录</p>
            </div>
        </section>

        <!-- 页脚 -->
        <footer class="text-center text-gray-500 text-sm py-6">
            <p>王智慧专属 &copy; 2023</p>
        </footer>
    </div>

    <!-- 提示弹窗 -->
    <div id="toast" class="fixed bottom-6 right-6 px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 flex items-center">
        <i class="mr-2"></i>
        <span></span>
    </div>

    <script>
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('wishForm');
            const historyContainer = document.getElementById('historyContainer');
            const emptyHistory = document.getElementById('emptyHistory');
            const toast = document.getElementById('toast');
            const exportBtn = document.getElementById('exportBtn');
            const importFile = document.getElementById('importFile');
            const clearBtn = document.getElementById('clearBtn');
            
            // 加载本地存储的历史记录
            loadHistory();
            
            // 表单提交事件
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // 获取表单数据
                const food = document.getElementById('food').value.trim();
                const thing = document.getElementById('thing').value.trim();
                const activity = document.getElementById('activity').value.trim();
                
                // 验证至少填写一项
                if (!food && !thing && !activity) {
                    showToast('请至少填写一项内容', 'error');
                    return;
                }
                
                // 创建记录对象
                const record = {
                    id: Date.now(), // 使用时间戳作为唯一ID
                    food,
                    thing,
                    activity,
                    time: new Date().toLocaleString()
                };
                
                // 保存记录
                saveRecord(record);
                
                // 显示成功提示
                showToast('保存成功！', 'success');
                
                // 重置表单
                form.reset();
            });
            
            // 导出数据
            exportBtn.addEventListener('click', () => {
                const records = JSON.parse(localStorage.getItem('wishes') || '[]');
                if (records.length === 0) {
                    showToast('没有可导出的数据', 'info');
                    return;
                }
                
                // 创建JSON文件并下载
                const dataStr = JSON.stringify(records, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `王智慧专属记录_${new Date().toLocaleDateString()}.json`;
                document.body.appendChild(a);
                a.click();
                
                // 清理
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 0);
                
                showToast('数据导出成功', 'success');
            });
            
            // 导入数据
            importFile.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        
                        // 验证导入的数据格式
                        if (!Array.isArray(importedData)) {
                            throw new Error('导入的数据格式不正确');
                        }
                        
                        // 合并数据（保留现有数据，添加新数据）
                        let existingData = JSON.parse(localStorage.getItem('wishes') || '[]');
                        // 过滤掉重复的记录（根据id）
                        const existingIds = new Set(existingData.map(item => item.id));
                        const newRecords = importedData.filter(item => 
                            !existingIds.has(item.id) && item.id && item.time
                        );
                        
                        // 合并并保存
                        const mergedData = [...newRecords, ...existingData];
                        localStorage.setItem('wishes', JSON.stringify(mergedData));
                        
                        // 重新加载历史记录
                        loadHistory();
                        showToast(`成功导入 ${newRecords.length} 条记录`, 'success');
                    } catch (error) {
                        showToast(`导入失败: ${error.message}`, 'error');
                    }
                };
                reader.readAsText(file);
                
                // 重置文件输入，允许重复选择同一文件
                importFile.value = '';
            });
            
            // 清空数据
            clearBtn.addEventListener('click', () => {
                const records = JSON.parse(localStorage.getItem('wishes') || '[]');
                if (records.length === 0) {
                    showToast('没有可清空的数据', 'info');
                    return;
                }
                
                if (confirm('确定要清空所有记录吗？此操作不可恢复。')) {
                    localStorage.removeItem('wishes');
                    loadHistory();
                    showToast('所有数据已清空', 'success');
                }
            });
            
            // 保存记录到本地存储
            function saveRecord(record) {
                // 从本地存储获取现有记录
                let records = JSON.parse(localStorage.getItem('wishes') || '[]');
                
                // 添加新记录
                records.unshift(record); // 添加到数组开头
                
                // 限制最多保存50条记录
                if (records.length > 50) {
                    records = records.slice(0, 50);
                }
                
                // 保存回本地存储
                localStorage.setItem('wishes', JSON.stringify(records));
                
                // 重新加载历史记录
                loadHistory();
            }
            
            // 加载历史记录
            function loadHistory() {
                // 清空现有内容（除了emptyHistory提示）
                while (historyContainer.children.length > 1) {
                    historyContainer.removeChild(historyContainer.lastChild);
                }
                
                // 从本地存储获取记录
                const records = JSON.parse(localStorage.getItem('wishes') || '[]');
                
                // 检查是否有记录
                if (records.length === 0) {
                    emptyHistory.style.display = 'block';
                    return;
                }
                
                // 隐藏空记录提示
                emptyHistory.style.display = 'none';
                
                // 添加记录到页面
                records.forEach(record => {
                    const recordElement = createRecordElement(record);
                    historyContainer.appendChild(recordElement);
                });
            }
            
            // 创建记录元素
            function createRecordElement(record) {
                const div = document.createElement('div');
                div.className = 'border border-gray-100 rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow bg-gray-50';
                div.setAttribute('data-id', record.id);
                
                let content = `<div class="text-xs text-gray-500 mb-2">${record.time}</div>`;
                
                if (record.food) {
                    content += `
                        <div class="flex items-center mb-1">
                            <i class="fa fa-cutlery text-primary text-sm mr-2"></i>
                            <span>想吃：${record.food}</span>
                        </div>
                    `;
                }
                
                if (record.thing) {
                    content += `
                        <div class="flex items-center mb-1">
                            <i class="fa fa-gift text-secondary text-sm mr-2"></i>
                            <span>想要：${record.thing}</span>
                        </div>
                    `;
                }
                
                if (record.activity) {
                    content += `
                        <div class="flex items-center">
                            <i class="fa fa-calendar-check-o text-accent text-sm mr-2"></i>
                            <span>想做：${record.activity}</span>
                        </div>
                    `;
                }
                
                // 添加删除按钮
                content += `
                    <button class="delete-btn text-gray-400 hover:text-red-500 text-xs mt-2" data-id="${record.id}">
                        <i class="fa fa-trash-o"></i> 删除
                    </button>
                `;
                
                div.innerHTML = content;
                
                // 添加删除事件
                div.querySelector('.delete-btn').addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('.delete-btn').dataset.id);
                    deleteRecord(id);
                });
                
                return div;
            }
            
            // 删除记录
            function deleteRecord(id) {
                let records = JSON.parse(localStorage.getItem('wishes') || '[]');
                records = records.filter(record => record.id !== id);
                localStorage.setItem('wishes', JSON.stringify(records));
                loadHistory();
                showToast('记录已删除', 'info');
            }
            
            // 显示提示
            function showToast(message, type = 'info') {
                const icon = toast.querySelector('i');
                const text = toast.querySelector('span');
                
                // 设置提示内容
                text.textContent = message;
                
                // 设置图标和样式
                icon.className = '';
                toast.className = 'fixed bottom-6 right-6 px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 flex items-center';
                
                switch (type) {
                    case 'success':
                        icon.className = 'fa fa-check-circle mr-2 text-green-500';
                        toast.classList.add('bg-green-100', 'text-green-800');
                        break;
                    case 'error':
                        icon.className = 'fa fa-exclamation-circle mr-2 text-red-500';
                        toast.classList.add('bg-red-100', 'text-red-800');
                        break;
                    case 'info':
                    default:
                        icon.className = 'fa fa-info-circle mr-2 text-blue-500';
                        toast.classList.add('bg-blue-100', 'text-blue-800');
                }
                
                // 显示提示
                setTimeout(() => {
                    toast.classList.remove('translate-y-20', 'opacity-0');
                    toast.classList.add('translate-y-0', 'opacity-100');
                }, 10);
                
                // 3秒后隐藏提示
                setTimeout(() => {
                    toast.classList.remove('translate-y-0', 'opacity-100');
                    toast.classList.add('translate-y-20', 'opacity-0');
                }, 3000);
            }
        });
    </script>
</body>
</html>
